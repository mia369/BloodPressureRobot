<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--接口位置-->
<mapper namespace="com.ht.bpr.mapper.RecordMapper">

    <insert id="insert" parameterType="Record" useGeneratedKeys="true">
        insert into bpr_record
        (open_id,
         high_blood_pressure,
         low_blood_pressure,
         heart_rate,
         used_pills,
         measure_time,
         create_time,
         update_time)
        values (#{openId},
                #{highBloodPressure},
                #{lowBloodPressure},
                #{heartRate},
                #{usedPills},
                #{measureTime},
                #{createTime},
                #{updateTime});
    </insert>

    <delete id="deleteByPk">
        delete
        from bpr_record
        where id = #{recordPk};
    </delete>

    <select id="selectByPk" resultType="com.ht.bpr.entity.Record">
        select *
        from bpr_record
        where id = #{recordPk};
    </select>

    <select id="select" parameterType="com.ht.bpr.entity.query.RecordQuery" resultType="com.ht.bpr.entity.Record">
        select *
        from bpr_record
        <where>
            open_id in
            <trim prefix="(" suffix=")" suffixOverrides=",">
                <foreach collection="query.openIds" item="openId" separator=",">
                    #{openId}
                </foreach>
            </trim>
            <if test="query.startTime != null">
                and measure_time &gt;= #{query.startTime}
            </if>
            <if test="query.endTime != null">
                and measure_time &lt;= #{query.endTime}
            </if>
        </where>
        <choose>
            <when test="query.sortOrder != null">
                <choose>
                    <when test="query.sortOrder.startsWith(&quot;A&quot;) || query.sortOrder.startsWith(&quot;a&quot;)">
                        order by measure_time asc
                    </when>
                    <otherwise>
                        order by measure_time desc
                    </otherwise>
                </choose>
            </when>
            <otherwise>
                order by measure_time asc
            </otherwise>
        </choose>
    </select>
</mapper>